CREATE TABLE product (category INT NOT NULL, id INT NOT NULL,
price DECIMAL, PRIMARY KEY(category, id)) ENGINE=INNODB;
CREATE TABLE customer (id INT NOT NULL, PRIMARY KEY (id)) ENGINE=INNODB;
CREATE TABLE product_order (no INT NOT NULL AUTO_INCREMENT,
product_category INT NOT NULL,
product_id INT NOT NULL,
customer_id INT NOT NULL,
PRIMARY KEY(no),
INDEX (product_category, product_id),
FOREIGN KEY (product_category, product_id)
REFERENCES product(category, id) ON UPDATE CASCADE ON DELETE RESTRICT,
INDEX (customer_id),
FOREIGN KEY (customer_id)
REFERENCES customer(id)
) ENGINE=INNODB;
SELECT * FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
WHERE table_name = 'product_order';
CONSTRAINT_CATALOG	def
CONSTRAINT_SCHEMA	test
CONSTRAINT_NAME	fk_product_order
UNIQUE_CONSTRAINT_CATALOG	def
UNIQUE_CONSTRAINT_SCHEMA	test
UNIQUE_CONSTRAINT_NAME	fk_product_order
MATCH_OPTION	NONE
UPDATE_RULE	CASCADE
DELETE_RULE	RESTRICT
TABLE_NAME	product_order
REFERENCED_TABLE_NAME	product
CONSTRAINT_CATALOG	def
CONSTRAINT_SCHEMA	test
CONSTRAINT_NAME	fk_product_order_2
UNIQUE_CONSTRAINT_CATALOG	def
UNIQUE_CONSTRAINT_SCHEMA	test
UNIQUE_CONSTRAINT_NAME	fk_product_order_2
MATCH_OPTION	NONE
UPDATE_RULE	???
DELETE_RULE	???
TABLE_NAME	product_order
REFERENCED_TABLE_NAME	customer
DROP TABLE product_order;
DROP TABLE product;
DROP TABLE customer;
